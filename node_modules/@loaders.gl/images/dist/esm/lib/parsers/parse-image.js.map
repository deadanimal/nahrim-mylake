{"version":3,"sources":["../../../../src/lib/parsers/parse-image.js"],"names":["assert","getImageOutputFormat","parseToNodeImage","parseToHTMLImage","parseToImageBitmap","parseSVG","SVG_DATA_URL_PATTERN","SVG_URL_PATTERN","parseImage","arrayBuffer","options","context","url","test","format"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,iBAAnB;AAEA,OAAOC,oBAAP,MAAiC,2BAAjC;AACA,OAAOC,gBAAP,MAA6B,uBAA7B;AACA,OAAOC,gBAAP,MAA6B,uBAA7B;AACA,OAAOC,kBAAP,MAA+B,yBAA/B;AACA,OAAOC,QAAP,MAAqB,aAArB;AAEA,IAAMC,oBAAoB,GAAG,uBAA7B;AACA,IAAMC,eAAe,GAAG,mBAAxB;AAGA,wBAA8BC,UAA9B;AAAA;AAAA;;;2DAAe,iBAA0BC,WAA1B,EAAuCC,OAAvC,EAAgDC,OAAhD;AAAA;;AAAA;AAAA;AAAA;AAAA;AACbD,YAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;AADa,mBAGCC,OAAO,IAAI,EAHZ,EAGNC,GAHM,QAGNA,GAHM;;AAAA,kBAITA,GAAG,KAAKN,oBAAoB,CAACO,IAArB,CAA0BD,GAA1B,KAAkCL,eAAe,CAACM,IAAhB,CAAqBD,GAArB,CAAvC,CAJM;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAKEP,QAAQ,CAACI,WAAD,EAAcC,OAAd,CALV;;AAAA;AAAA;;AAAA;AAQPI,YAAAA,MARO,GAQEb,oBAAoB,CAACS,OAAD,CARtB;AAAA,0BASLI,MATK;AAAA,4CAUN,aAVM,wBAYN,MAZM,wBAcN,SAdM;AAAA;;AAAA;AAAA;AAAA,mBAWIV,kBAAkB,CAACK,WAAD,EAAcC,OAAd,CAXtB;;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAaIP,gBAAgB,CAACM,WAAD,EAAcC,OAAd,CAbpB;;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAeIR,gBAAgB,CAACO,WAAD,EAAcC,OAAd,CAfpB;;AAAA;AAAA;;AAAA;AAAA,6CAiBFV,MAAM,CAAC,KAAD,CAjBJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import assert from '../utils/assert';\n\nimport getImageOutputFormat from './get-image-output-format';\nimport parseToNodeImage from './parse-to-node-image';\nimport parseToHTMLImage from './parse-to-html-image';\nimport parseToImageBitmap from './parse-to-image-bitmap';\nimport parseSVG from './parse-svg';\n\nconst SVG_DATA_URL_PATTERN = /^data:image\\/svg\\+xml/;\nconst SVG_URL_PATTERN = /\\.svg((\\?|#).*)?$/;\n\n// Parse to platform defined image type (ndarray on node, ImageBitmap or HTMLImage on browser)\nexport default async function parseImage(arrayBuffer, options, context) {\n  options = options || {};\n\n  const {url} = context || {};\n  if (url && (SVG_DATA_URL_PATTERN.test(url) || SVG_URL_PATTERN.test(url))) {\n    return await parseSVG(arrayBuffer, options);\n  }\n\n  const format = getImageOutputFormat(options);\n  switch (format) {\n    case 'imagebitmap':\n      return await parseToImageBitmap(arrayBuffer, options);\n    case 'html':\n      return await parseToHTMLImage(arrayBuffer, options);\n    case 'ndarray':\n      return await parseToNodeImage(arrayBuffer, options);\n    default:\n      return assert(false);\n  }\n}\n"],"file":"parse-image.js"}